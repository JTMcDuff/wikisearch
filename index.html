<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Wikisearch</title>
  </head>
  <body>
  	<header>
  		<h1>Wikisearch</h1>
  		<form>
	  		<input type="text" id="search-input" name="Search Wikipedia" value="Search Me">
	  		<button type="button" name="Search Button" onclick="startSearch()">
	  			Search
	  		</button>
  		</form>
  	</header>

  	<main>
  		<h2> Search Results</h2>

  		<div id="search-results"></div>
  			

  		</div>

  	</main>


  </body>

  <script>
  	function startSearch() {
  		var searchTerm = document.getElementById('search-input').value;
  		document.getElementById('search-input').value = '';
  		
  		searchWiki(searchTerm);
  	};

  	// *** API AND PROCESSING FUNCTIONS ***
  	function searchWiki(searchTerm) {
  		const url = constructURL(searchTerm);
		const response = fetch(url, {
		    method: 'GET',
		    headers:{
	        	'Content-Type': 'application/json'
	      	}
		})
		.then(response =>{
			return response.json();
		})
		.then(resJson =>{
			console.log(resJson.query);
		})
		.catch(error => {
			// TODO JOHNNY: Update with more effective error handling.
			console.log(error);
			alert(error);
		});
		//let myResults = await response;
		//console.log('result ', myResults);
  	};

  	function constructURL(searchTerm) {
  		// Designed for future expansion
		let url = new URL('https://en.wikipedia.org/w/api.php'),
    	params = {
    		'action': 'query',
    		'list':'search',
    		'srsearch': searchTerm,
    		'format':'json',
    		'origin': '*'
    	};
		Object.keys(params).forEach(key => url.searchParams.append(key, params[key]));
		console.log('My URL', url);
  		return url;
  	};

  	// *** API AND PROCESSING FUNCTIONS ***

  	function renderResults(results) {
  		var result = document.createElement('p');
  		var node = document.createTextNode(results);
  		result.appendChild(node);
  		document.getElementById('search-results').appendChild(result);
  	};

  	constructURL('abc');

  </script>
</html>